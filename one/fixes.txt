Here are the fixes for the bug.
fixed another bug